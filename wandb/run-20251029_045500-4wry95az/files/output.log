Training classifier for TP=2
Number of unique states across all TP=2 samples: 6
Class weights: [0.19936813 0.24231766 1.6184283  1.344441   1.5975207  0.9979242 ]
Train size: 25, Val size: 4
Epoch 1/500: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00,  7.88it/s, loss=2.0453]
Epoch 2/500: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 46.50it/s, loss=2.0113]
Epoch 3/500: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 49.03it/s, loss=1.9884]
Epoch 4/500: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 50.93it/s, loss=2.0123]
Epoch 5/500: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 55.21it/s, loss=1.9456]
Epoch 6/500: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 54.89it/s, loss=1.9333]
Epoch 7/500: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 54.96it/s, loss=1.9095]
Epoch 8/500: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 55.18it/s, loss=1.9100]
Epoch 9/500: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 54.87it/s, loss=1.8868]
Epoch 10/500: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 55.15it/s, loss=1.8906]
TP 2, Epoch 10, Train Loss: 1.9096, Val Loss: 1.8708, Val Acc: 0.1919, Val F1: 0.1502, Trans MAE: 261.5808, AutoCorr R²: 0.6063, Tol.Acc(25W): 0.192, Boundary F1: 0.206
Epoch 11/500: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 55.05it/s, loss=1.9131]
Epoch 12/500: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 54.79it/s, loss=1.9488]
Epoch 13/500: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 54.94it/s, loss=1.8368]
Epoch 14/500: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 55.11it/s, loss=1.8836]
Epoch 15/500: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 55.18it/s, loss=1.8692]
Epoch 16/500: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 55.20it/s, loss=1.8444]
Epoch 17/500: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 54.87it/s, loss=1.8514]
Epoch 18/500: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 55.07it/s, loss=2.0184]
Epoch 19/500: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 55.08it/s, loss=1.8347]
Epoch 20/500: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 55.20it/s, loss=1.7524]
TP 2, Epoch 20, Train Loss: 1.8248, Val Loss: 1.8200, Val Acc: 0.3963, Val F1: 0.2334, Trans MAE: 151.3727, AutoCorr R²: 0.9053, Tol.Acc(25W): 0.396, Boundary F1: 0.198
Epoch 21/500: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 55.08it/s, loss=1.7517]
Epoch 22/500: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 53.28it/s, loss=1.8386]
Epoch 23/500: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 55.18it/s, loss=1.7815]
Epoch 24/500: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 55.08it/s, loss=1.7832]
Epoch 25/500: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 54.90it/s, loss=1.7816]
Epoch 26/500: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 55.23it/s, loss=1.8942]
Epoch 27/500: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 55.28it/s, loss=1.7646]
Epoch 28/500: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 55.26it/s, loss=2.0109]
Epoch 29/500: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 54.05it/s, loss=1.7898]
Epoch 30/500: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 54.94it/s, loss=1.6491]
TP 2, Epoch 30, Train Loss: 1.7669, Val Loss: 1.7827, Val Acc: 0.5182, Val F1: 0.2635, Trans MAE: 106.5547, AutoCorr R²: 0.8749, Tol.Acc(25W): 0.518, Boundary F1: 0.173
Epoch 31/500: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 55.03it/s, loss=1.7624]
Epoch 32/500: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 54.96it/s, loss=1.5224]
Epoch 33/500: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 55.18it/s, loss=1.8792]
Epoch 34/500: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 55.07it/s, loss=1.7941]
Epoch 35/500: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 55.14it/s, loss=1.7043]
Epoch 36/500: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 54.58it/s, loss=1.7299]
Epoch 37/500: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 55.09it/s, loss=1.8398]
Epoch 38/500: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 55.13it/s, loss=1.8662]
Epoch 39/500: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 54.90it/s, loss=1.5810]
Epoch 40/500: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 54.53it/s, loss=1.8342]
TP 2, Epoch 40, Train Loss: 1.7949, Val Loss: 1.7567, Val Acc: 0.5583, Val F1: 0.2739, Trans MAE: 90.8694, AutoCorr R²: 0.9167, Tol.Acc(25W): 0.558, Boundary F1: 0.157
Epoch 41/500: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 54.97it/s, loss=1.5728]
Epoch 42/500: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 55.36it/s, loss=1.7119]
Epoch 43/500: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 54.48it/s, loss=1.8193]
Epoch 44/500: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 55.07it/s, loss=1.8096]
Epoch 45/500: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 55.23it/s, loss=1.7096]
Epoch 46/500: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 55.05it/s, loss=1.6912]
Epoch 47/500: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 54.50it/s, loss=1.7154]
Epoch 48/500: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 54.29it/s, loss=1.8191]
Epoch 49/500: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 54.91it/s, loss=1.7859]
Epoch 50/500: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 55.32it/s, loss=1.7107]
TP 2, Epoch 50, Train Loss: 1.7562, Val Loss: 1.7579, Val Acc: 0.5290, Val F1: 0.2811, Trans MAE: 99.8228, AutoCorr R²: 0.7371, Tol.Acc(25W): 0.529, Boundary F1: 0.148
Epoch 51/500: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 54.89it/s, loss=1.7006]
Epoch 52/500: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 54.95it/s, loss=1.7587]
Epoch 53/500: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 55.10it/s, loss=1.8263]
Epoch 54/500: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 54.89it/s, loss=1.4600]
Epoch 55/500: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 55.03it/s, loss=1.4811]
Epoch 56/500: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 54.36it/s, loss=1.7850]
Epoch 57/500: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 55.15it/s, loss=1.8594]
Epoch 58/500: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 55.26it/s, loss=1.7151]
Epoch 59/500: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 55.07it/s, loss=1.7390]
Epoch 60/500: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 54.33it/s, loss=1.5681]
TP 2, Epoch 60, Train Loss: 1.7184, Val Loss: 1.7397, Val Acc: 0.5838, Val F1: 0.2863, Trans MAE: 82.7790, AutoCorr R²: 0.6504, Tol.Acc(25W): 0.584, Boundary F1: 0.151
Epoch 61/500: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 54.89it/s, loss=1.4633]
Epoch 62/500: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 55.08it/s, loss=1.7497]
Epoch 63/500: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 55.17it/s, loss=1.7011]
Epoch 64/500: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 54.87it/s, loss=1.8025]
Epoch 65/500: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 55.07it/s, loss=1.6052]
Epoch 66/500: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 55.05it/s, loss=1.5382]
Epoch 67/500: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 55.30it/s, loss=1.6854]
Epoch 68/500: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 54.88it/s, loss=1.6965]
Epoch 69/500: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 55.02it/s, loss=1.8251]
Epoch 70/500: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 53.95it/s, loss=1.7087]
TP 2, Epoch 70, Train Loss: 1.7461, Val Loss: 1.7378, Val Acc: 0.5467, Val F1: 0.2850, Trans MAE: 92.2553, AutoCorr R²: 0.8486, Tol.Acc(25W): 0.547, Boundary F1: 0.142
Epoch 71/500:  25%|████████████████████████████████████                                                                                                            | 1/4 [00:00<00:00, 38.08it/s, loss=1.7619]
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/home/azureuser/powertrace-sim/model/train_entry.py", line 147, in <module>
    classifier, metrics = train_classifiers(
                          ^^^^^^^^^^^^^^^^^^
  File "/home/azureuser/powertrace-sim/model/classifiers/train.py", line 796, in train_classifiers
    loss = criterion(logits.view(-1, K), z.view(-1))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/azureuser/miniconda3/envs/inference/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/azureuser/miniconda3/envs/inference/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/azureuser/miniconda3/envs/inference/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1310, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/azureuser/miniconda3/envs/inference/lib/python3.12/site-packages/torch/nn/functional.py", line 3462, in cross_entropy
    return torch._C._nn.cross_entropy_loss(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
